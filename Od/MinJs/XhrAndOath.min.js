var Oath,Xhr;(function(n){var f=1,t,u;n.resolve=function(t){return n.make(function(n){return n(t)})};n.reject=function(t){return n.make(function(n,i){return i(t)})};n.all=function(t){return n.make(function(n){var i=[],r=t.length;t.forEach(function(t,u){t.then(function(t){i[u]=t;--r||n(i)})})})};n.race=function(t){return n.make(function(n){t.forEach(function(t){t.then(function(t){n(t)})})})};n.delay=function(i,r){return n.make(function(n){setTimeout(function(){n(t(r)?r():r)},i)})};t=function(n){return n instanceof Function};u=function(n){return n&&t(n.then)};n.make=function(t){var i={value:null,state:r,onFulfilled:null,onRejected:null,then:null,id:f++},u=function(n){return e(i,n)},s=function(n){return o(i,n)};return t(u,s),i.then=function(t,r){return n.make(function(n,u){i.state(i,t,r,n,u)})},i};var e=function(n,t){n.state===r&&(n.state=s,n.value=t,n.onFulfilled&&setTimeout(n.onFulfilled,0,t),n.onFulfilled=null)},o=function(n,t){n.state===r&&(n.state=h,n.value=t,n.onRejected&&setTimeout(n.onRejected,0,t),n.onRejected=null)},r=function(n,t,r,u,f){var o=n.onFulfilled,e;n.onFulfilled=function(r){o&&o(r);t?i(n,t,u,f):u(r)};e=n.onRejected;n.onRejected=function(t){e&&e(t);r?i(n,r,u,f):f(t)}},s=function(n,t,r,u,f){t&&setTimeout(i,0,n,t,u,f)},h=function(n,t,r,u,f){r&&setTimeout(i,0,n,r,u,f)},i=function(n,i,r,f){try{if(!t(i))return;var o=n.value,e=i(o);if(e===n)throw new TypeError("Cyclic promise.");u(e)?e.then(r,f):r(e)}catch(s){f(s)}}})(Oath||(Oath={})),function(n){n.send=function(n,i){var u,f,e,o;i===void 0&&(i={});var r=new XMLHttpRequest,s=i.method||"GET",h=i.async!==!1,c=i.user,l=i.password;if(r.open(s,n,h,c,l),u=i.requestHeaders,u)for(f in u)e=u[f],r.setRequestHeader(f,e);return i.timeout!=null&&(r.timeout=i.timeout),i.withCredentials!=null&&(r.withCredentials=i.withCredentials),i.onprogress&&r.addEventListener("progress",i.onprogress),i.overrideMimeType&&r.overrideMimeType(i.overrideMimeType),o=Oath.make(function(n,i){r.onreadystatechange=t(r,n,i)}),r.send(i.data),o};var t=function(n,t,i){return function(){n.readyState===4&&(200<=n.status&&n.status<300?t:i)(n)}}}(Xhr||(Xhr={}));