var Jigsaw;(function(n){n.addRoute=function(n,i){var r={route:n,matcher:h(n),handler:i};t.push(r)};n.removeRoute=function(n){t=t.filter(function(t){return t.route===n})};n.clearRoutes=function(){t=[]};n.defaultRouteHandler=null;n.takeRoute=function(i){var e=i.lastIndexOf("?"),u="",s,f,o,r;for(e!==-1&&(u=i.substr(e+1),i=i.substr(0,e)),s=i?i.split("/").map(decodeURIComponent):[],f=0;f<t.length;f++)if(o=t[f],r=o.matcher(s,0,{}),r){r["#"]=i;r["?"]=u;u!=null&&(r["?"]=u);o.handler(r);return}n.defaultRouteHandler&&n.defaultRouteHandler(i)};n.startRouter=function(){window.addEventListener("hashchange",r)};n.stopRouter=function(){window.removeEventListener("hashchange",r)};n.parseQuery=function(n){var i=(n||"").replace(/\+/g," ").split(/[&;]/),t={};return i.forEach(function(n){var i=n.indexOf("="),r,u;i===-1&&(i=n.length);r=n.substr(0,i);u=decodeURIComponent(n.substr(i+1));t[r]=u}),t};var i=null,r=function(){var t=location.hash.substr(1);t!==i&&(n.takeRoute(t),i=t)},u=function(n,t,i){return n[t]==null&&i},f=function(n,t){return function(i,r,u){return i[r]===n&&t(i,r+1,u)}},e=function(n,t){return function(i,r,u){var f=i[r];return f==null?null:(u[n]=f,t(i,r+1,u))}},o=function(n,t){return function(i,r,u){var f=i[r];return u[n]=f,t(i,r+1,u)}},s=function(n,t){return function(i,r,u){return u[n]=i.slice(r),t(i,i.length,u)}},h=function(n){var h,t,r,i;if(!n)return u;for(h=n.split("/"),t=u,r=h.length-1;0<=r;r--){i=h[r];switch(i[0]){case":":t=e(i,t);continue;case"?":t=o(i,t);continue;case"*":t=s(i,t);continue;default:t=f(i,t);continue}}return t},t=[]})(Jigsaw||(Jigsaw={}));